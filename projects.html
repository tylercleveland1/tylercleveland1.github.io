<!DOCTYPE html>
<html>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script src="/scripts/utility.js"></script>
    <script src="/scripts/notebook.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    <head>
    </head>
    <body class="bg-light">
        <style>
            .card {
                margin-top: 15px;
            }

            .card-title {
                padding-left: 25px;
                padding-top: 25px;
            }
        </style>
        <div id="divNav">
        </div>

        <div class="project-selector card mx-auto" style="width: 90%;">
            <h5 class="card-title">
                Projects
            </h5>
            <div class="card-body">
                <div class="row">
                    <div class="col-sm-4">
                        <div id="divProjectList" class="list-group">
                            <a href="#" class="lnk-load-project list-group-item list-group-item-action"></a>
                        </div>
                    </div>
                    <div class="col-sm-8">
                        <div class="project-container card mx-auto" style="width: 95%; min-height: 50px;">
                            <h5 class="card-title">
                                Loading Project...
                            </h5>
                            <div class="card-body">
                                <div id="divProjectBody" class="project-body" style="overflow-y: auto;">
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </body>
    <script>
        $(document).ready(function () {
            var $divNav = $('#divNav');
            var navController = $divNav.loadNavbar(activeNavItem=navItems.Projects);

            //load project list
            var $divProjectList = $('#divProjectList');
            var $aTemplate = $divProjectList.find('a:first');
            var aTemplateHtml = $aTemplate.prop('outerHTML');
            $aTemplate.remove();
            for (var pIdx in projects) {
                var $a = $(aTemplateHtml);
                $divProjectList.append($a);
                $a.attr('htmllink', projects[pIdx].htmllink);
                $a.text(projects[pIdx].title);
            }

            $('.lnk-load-project').on('click', function () {
                var $projectContainer = $('.project-container');
                var $projectSelector = $('.project-selector');
                var $projectBody = $('.project-body');

                var $activeLink = $(this);
                $projectSelector.find('#divProjectList > a.active').removeClass('active');
                $activeLink.addClass('active');

                

                $.get($activeLink.attr('htmllink'), function(ipynbStr) {
                    //notebook.js
                    var notebook = nb.parse(JSON.parse(ipynbStr));
                    var rendered = notebook.render();
                    $projectBody.html(rendered);

                    // if (typeof MathJax !== 'undefined') {
                    //     MathJax.Hub.Queue(['Typeset', MathJax.Hub, 'divProjectBody']);
                    // }
                    renderMathInElement($projectBody.get(0), {});

                    $projectContainer.find('.card-title').text($activeLink.text());
                }, 'html');

                // $projectBody.load($activeLink.attr('htmllink'), function () {
                //     if (typeof MathJax !== 'undefined') {
                //         MathJax.Hub.Queue(['Typeset', MathJax.Hub, 'divProjectBody']);
                //     }

                //     $projectContainer.find('.card-title').text($activeLink.text());
                // });
            });

            //trigger click on first nav item
            $('.project-selector #divProjectList > a:first').trigger('click');
        });
    </script>
</html>